<div
  class="mt-4 w-full rounded-xl max-h-[320px] border border-zinc-800 bg-zinc-900 overflow-hidden"
>
  <!-- Header (sticky) -->
  <div
    class="hidden md:grid grid-cols-5 gap-3 px-4 py-3 border-b border-zinc-800 text-xs font-medium uppercase tracking-wide text-zinc-400 sticky top-0 bg-zinc-900 z-10"
  >
    <div>Importo</div>
    <div>Rata mensile</div>
    <div>Mesi</div>
    <div>Motivo</div>
    <div>Stato</div>
  </div>

  <!-- Scroll container -->
  <div class="max-h-[420px] overflow-y-auto">
    @for (loan of loansTable; track $index) {
    <!-- Desktop rows -->
    <div
      class="hidden md:grid grid-cols-5 gap-3 px-4 py-3 border-b border-zinc-800 last:border-b-0 text-sm text-zinc-100"
    >
      <!-- Importo -->
      <div class="font-medium">
        {{ loan.amount | currency : "EUR" : "symbol" : "1.0-0" }}
      </div>
      <!-- Rata mensile -->
      <div>
        {{ loan.monthlyPayment | currency : "EUR" : "symbol" : "1.2-2" }}
      </div>
      <!-- Mesi -->
      <div>
        {{ loan.months }}
      </div>
      <!-- Motivo -->
      <div class="truncate" [title]="loan.purpose">{{ loan.purpose }}</div>
      <!-- Stato -->
      <div>
        <span
          class="inline-flex items-center rounded-full px-2 py-0.5 text-xs border"
          [ngClass]="{
            'bg-emerald-900/40 text-emerald-300 border-emerald-700/50':
              loan.status === 'APPROVED',
            'bg-amber-900/40 text-amber-300 border-amber-700/50':
              loan.status === 'PENDING',
            'bg-orange-900/40 text-orange-300 border-orange-700/50':
              loan.status === 'SUBMITTED',
            'bg-red-900/40 text-red-300 border-red-700/50':
              loan.status === 'DECLINED' || loan.status === 'REJECTED',
            'bg-zinc-800 text-zinc-300 border-zinc-700/50': ![
              'APPROVED',
              'PENDING',
              'SUBMITTED',
              'DECLINED',
              'REJECTED'
            ].includes(loan.status ?? '')
          }"
        >
          {{ loan.status }}
        </span>
      </div>
    </div>

    <!-- Mobile cards -->
    <div class="md:hidden px-4 py-3 border-b border-zinc-800 last:border-b-0">
      <div class="flex items-baseline justify-between gap-3">
        <div class="text-sm text-zinc-400">Importo</div>
        <div class="text-sm font-medium text-zinc-100">
          {{ loan.amount | currency : "EUR" : "symbol" : "1.0-0" }}
        </div>
      </div>
      <div class="mt-2 grid grid-cols-2 gap-2 text-sm">
        <div class="flex items-center justify-between">
          <span class="text-zinc-400">Rata</span>
          <span class="text-zinc-100">
            {{ loan.monthlyPayment | currency : "EUR" : "symbol" : "1.2-2" }}
          </span>
        </div>
        <div class="flex items-center justify-between">
          <span class="text-zinc-400">Mesi</span>
          <span class="text-zinc-100">{{ loan.months }}</span>
        </div>
        <div class="col-span-2 flex items-center justify-between">
          <span class="text-zinc-400">Motivo</span>
          <span
            class="text-zinc-100 truncate max-w-[60%]"
            [title]="loan.purpose"
          >
            {{ loan.purpose }}
          </span>
        </div>
        <div class="col-span-2 flex items-center justify-between">
          <span class="text-zinc-400">Stato</span>
          <span
            class="inline-flex items-center rounded-full px-2 py-0.5 text-xs border"
            [ngClass]="{
              'bg-emerald-900/40 text-emerald-300 border-emerald-700/50':
                loan.status === 'APPROVED',
              'bg-amber-900/40 text-amber-300 border-amber-700/50':
                loan.status === 'PENDING',
              'bg-orange-900/40 text-orange-300 border-orange-700/50':
                loan.status === 'SUBMITTED',
              'bg-red-900/40 text-red-300 border-red-700/50':
                loan.status === 'DECLINED' || loan.status === 'REJECTED',
              'bg-zinc-800 text-zinc-300 border-zinc-700/50': ![
                'APPROVED',
                'PENDING',
                'SUBMITTED',
                'DECLINED',
                'REJECTED'
              ].includes(loan.status ?? '')
            }"
          >
            {{ loan.status }}
          </span>
        </div>
      </div>
    </div>
    } @if (!loansTable?.length) {
    <div class="px-4 py-6 text-sm text-zinc-400">Nessun prestito trovato.</div>
    }
  </div>
</div>
